<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Workout Log</title>
  <style>
    :root {
      --bg: #0b1220;
      --card: #111827;
      --card-2: #020617;
      --border: #1f2937;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #38bdf8;
      --done: #22c55e;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background: radial-gradient(1200px 600px at 20% -10%, #0f172a, var(--bg));
      color: var(--text);
      padding: 24px;
    }

    .container {
      max-width: 1200px;
      margin: auto;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    h1 {
      font-size: 22px;
      margin: 0;
    }

    .subtitle {
      color: var(--muted);
      font-size: 13px;
    }

    .card {
      background: linear-gradient(180deg, #020617, #020617) padding-box,
        linear-gradient(180deg, #1f2937, #020617) border-box;
      border: 1px solid transparent;
      border-radius: 18px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, .45);
      padding: 16px;
      margin-bottom: 24px;
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      font-size: 13px;
    }

    thead th {
      position: sticky;
      top: 0;
      background: var(--card);
      z-index: 2;
      color: var(--muted);
      font-weight: 500;
      padding: 10px 6px;
      border-bottom: 1px solid var(--border);
    }

    tbody td {
      padding: 8px 6px;
      border-bottom: 1px solid var(--border);
      text-align: center;
    }

    tbody tr:hover {
      background: rgba(56, 189, 248, .04);
    }

    td.group {
      text-align: left;
      font-weight: 600;
      padding-left: 12px;
      white-space: nowrap;
      cursor: pointer;
      color: var(--accent);
    }

    td.group:hover {
      text-decoration: underline;
    }

    .cell {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
    }

    input {
      width: 46px;
      height: 32px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      text-align: center;
      font-size: 13px;
    }

    input:focus {
      outline: none;
      border-color: var(--accent);
    }

    button.set {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--muted);
      cursor: pointer;
      transition: .15s;
      font-weight: 600;
    }

    button.set.done {
      background: var(--done);
      border-color: var(--done);
      color: #052e16;
    }

    button.set:hover {
      border-color: var(--accent);
      color: var(--accent);
    }

    .controls {
      display: flex;
      gap: 12px;
      margin-top: 16px;
    }

    .controls button {
      padding: 10px 16px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--text);
      cursor: pointer;
      font-weight: 500;
    }

    .controls button.primary {
      background: linear-gradient(180deg, #38bdf8, #0ea5e9);
      color: #002233;
      border: none;
    }

    #stats h2 {
      margin: 0 0 12px 0;
      font-size: 16px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 12px;
    }

    .stat {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
    }

    .stat .label {
      font-size: 12px;
      color: var(--muted);
    }

    .stat .value {
      font-size: 22px;
      font-weight: 600;
      margin-top: 4px;
    }

    /* Timer Styles */
    .timer-container {
      background: var(--card-2);
      margin-bottom: 20px;
      border-radius: 12px;
      padding: 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: 1px solid var(--border);
    }

    .timer-display {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      font-size: 32px;
      font-weight: 700;
      color: var(--accent);
      min-width: 100px;
    }

    .timer-controls {
      display: flex;
      gap: 8px;
    }

    .timer-btn {
      background: var(--card);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: .2s;
      font-weight: 500;
    }

    .timer-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
    }

    .timer-btn.active {
      background: var(--accent);
      color: #0b1220;
      border-color: var(--accent);
    }

    #modalImg {
      background-color: #fff;
    }
  </style>
</head>

<body>
  <div class="container">

    <header>
      <div>
        <h1>Workout Log</h1>
        <div class="subtitle">2 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ¬∑ 4 –ø–æ–¥—Ö–æ–¥–∞ ¬∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–æ–π</div>
      </div>
    </header>

    <div class="card">
      <table id="log"></table>
    </div>

    <div id="stats" class="card"></div>

    <div class="controls">
      <button class="primary" onclick="saveData()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      <button onclick="resetData()">–°–±—Ä–æ—Å</button>
      <button onclick="toggleZapper()" id="zapperBtn" style="position:relative;">
        <span id="zapperIcon" style="opacity:0.5">‚ö°</span> Zapper
        <div id="zapperStatus"
          style="display:none; position:absolute; top:-4px; right:-4px; width:8px; height:8px; background:#ef4444; border-radius:50%; box-shadow: 0 0 10px #ef4444;">
        </div>
      </button>
    </div>

  </div>

  <!-- Modal -->
  <div id="modal" onclick="if(event.target===this)closeModal()"
    style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.7); backdrop-filter:blur(8px); -webkit-backdrop-filter:blur(8px); z-index:1000; overflow-y:auto;">
    <div
      style="max-width:550px; margin:4% auto; background:var(--card); border-radius:18px; padding:24px; position:relative; box-shadow:0 25px 50px -12px rgba(0,0,0,0.5);">
      <button onclick="closeModal()"
        style="position:absolute; right:16px; top:16px; background:none; border:none; color:var(--muted); font-size:24px; cursor:pointer; padding:4px; line-height:1; z-index:10;">‚úï</button>
      <h2 id="modalTitle" style="margin-top:0; font-size:24px; margin-bottom:16px;"></h2>
      <img id="modalImg"
        style="width:100%; border-radius:12px; border:1px solid var(--border); margin-bottom:20px; aspect-ratio:16/9; object-fit:cover;" />

      <!-- Timer Interface -->
      <div class="timer-container">
        <div id="timerDisplay" class="timer-display">00:00</div>
        <div class="timer-controls">
          <button class="timer-btn" onclick="addTime(30)">+30s</button>
          <button class="timer-btn" onclick="toggleTimer()" id="timerToggleBtn">Start</button>
          <button class="timer-btn" onclick="resetTimer()">Reset</button>
        </div>
      </div>

      <div id="sideAlert"
        style="display:none; background:rgba(56, 189, 248, 0.1); border:1px solid var(--accent); color:var(--accent); padding:10px; border-radius:8px; margin-bottom:16px; font-weight:500; text-align:center;">
        ‚ö†Ô∏è –ù–µ –∑–∞–±—É–¥—å—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞ –≤—Ç–æ—Ä—É—é —Å—Ç–æ—Ä–æ–Ω—É!
      </div>

      <div id="modalDesc" style="color:var(--text); line-height:1.6; font-size:15px;"></div>
    </div>
  </div>

  <script>
    const muscles = ['–ù–æ–≥–∏', '–ò–∫—Ä—ã', '–ì—Ä—É–¥—å', '–°–ø–∏–Ω–∞', '–ö–æ—Ä'];

    const muscleDescriptions = {
      '–ù–æ–≥–∏': `
        <h3 style="margin-top:0; color:var(--accent);">–ë–æ–ª–≥–∞—Ä—Å–∫–∏–µ —Å–ø–ª–∏—Ç-–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è</h3>
        <p>–≠—Ç–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ –ª—É—á—à–µ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≥ –±–µ–∑ –≤–µ—Å–∞. –ó–∞ —Å—á–µ—Ç —Ç–æ–≥–æ, —á—Ç–æ –æ–¥–Ω–∞ –Ω–æ–≥–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞ –∏–∑ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –≤–æ–∑–≤—ã—à–µ–Ω–∏–∏ (–¥–∏–≤–∞–Ω, —Å—Ç—É–ª), —Ä–∞–±–æ—á–∞—è –Ω–æ–≥–∞ –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–ª–æ—Å—Å–∞–ª—å–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∏ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏–µ.</p>
        <p><strong>–¢–µ—Ö–Ω–∏–∫–∞:</strong> –í—Å—Ç–∞–Ω—å—Ç–µ —Å–ø–∏–Ω–æ–π –∫ —Å—Ç—É–ª—É/–¥–∏–≤–∞–Ω—É, –ø–æ–ª–æ–∂–∏—Ç–µ –ø–æ–¥—ä–µ–º –∑–∞–¥–Ω–µ–π –Ω–æ–≥–∏ –Ω–∞ –æ–ø–æ—Ä—É. –°–¥–µ–ª–∞–π—Ç–µ —à–∞–≥ –≤–ø–µ—Ä–µ–¥ —Ä–∞–±–æ—á–µ–π –Ω–æ–≥–æ–π. –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π—Ç–µ—Å—å –≤–Ω–∏–∑, –ø–æ–∫–∞ –±–µ–¥—Ä–æ –ø–µ—Ä–µ–¥–Ω–µ–π –Ω–æ–≥–∏ –Ω–µ —Å—Ç–∞–Ω–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ø–æ–ª—É. –ö–æ–ª–µ–Ω–æ –∑–∞–¥–Ω–µ–π –Ω–æ–≥–∏ –ø–æ—á—Ç–∏ –∫–∞—Å–∞–µ—Ç—Å—è –ø–æ–ª–∞. –î–µ—Ä–∂–∏—Ç–µ –∫–æ—Ä–ø—É—Å —Ä–æ–≤–Ω–æ –∏–ª–∏ —Å–ª–µ–≥–∫–∞ –Ω–∞–∫–ª–æ–Ω–∏—Ç–µ –≤–ø–µ—Ä–µ–¥ –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –∞–∫—Ü–µ–Ω—Ç–∞ –Ω–∞ —è–≥–æ–¥–∏—Ü—É.</p>
        <p><strong>–ü–æ—á–µ–º—É —ç—Ç–æ —Ç–æ–ø:</strong> –†–∞–∑–≤–∏–≤–∞–µ—Ç —Å–∏–ª—É, –º–∞—Å—Å—É, –±–∞–ª–∞–Ω—Å –∏ –º–æ–±–∏–ª—å–Ω–æ—Å—Ç—å —Ç–∞–∑–æ–±–µ–¥—Ä–µ–Ω–Ω–æ–≥–æ —Å—É—Å—Ç–∞–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.</p>
      `,
      '–ò–∫—Ä—ã': `
        <h3 style="margin-top:0; color:var(--accent);">–ü–æ–¥—ä–µ–º –Ω–∞ –Ω–æ—Å–æ–∫ –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ –Ω–∞ –≤–æ–∑–≤—ã—à–µ–Ω–Ω–æ—Å—Ç–∏</h3>
        <p>–ò–∫—Ä—ã –æ—á–µ–Ω—å –≤—ã–Ω–æ—Å–ª–∏–≤—ã, –∏—Ö –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–º–∏ –ø–æ–¥—ä–µ–º–∞–º–∏ –Ω–∞ –¥–≤—É—Ö –Ω–æ–≥–∞—Ö –±–µ–∑ –≤–µ—Å–∞ –ø–æ 100 —Ä–∞–∑. –°–µ–∫—Ä–µ—Ç —Ä–æ—Å—Ç–∞ ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏–µ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π.</p>
        <p><strong>–¢–µ—Ö–Ω–∏–∫–∞:</strong> –í—Å—Ç–∞–Ω—å—Ç–µ –æ–¥–Ω–æ–π –Ω–æ–≥–æ–π –Ω–∞ –∫—Ä–∞–π —Å—Ç—É–ø–µ–Ω—å–∫–∏, —Ç–æ–ª—Å—Ç–æ–π –∫–Ω–∏–≥–∏ –∏–ª–∏ –ø–æ—Ä–æ–≥–∞. –í—Ç–æ—Ä–∞—è –Ω–æ–≥–∞ –ø–æ–¥–∂–∞—Ç–∞. –û–ø—É—Å—Ç–∏—Ç–µ –ø—è—Ç–∫—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –Ω–∏–∑–∫–æ, –ø–æ—á—É–≤—Å—Ç–≤—É–π—Ç–µ —Å–∏–ª—å–Ω–æ–µ –Ω–∞—Ç—è–∂–µ–Ω–∏–µ –≤ –∏–∫—Ä–µ. –ú–æ—â–Ω—ã–º –¥–≤–∏–∂–µ–Ω–∏–µ–º –ø–æ–¥–Ω–∏–º–∏—Ç–µ—Å—å –Ω–∞ –Ω–æ—Å–æ–∫ –∫–∞–∫ –º–æ–∂–Ω–æ –≤—ã—à–µ, –∑–∞–¥–µ—Ä–∂–∏—Ç–µ—Å—å –Ω–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã –≤ –ø–∏–∫–æ–≤–æ–º —Å–æ–∫—Ä–∞—â–µ–Ω–∏–∏. –û–ø—É—Å–∫–∞–π—Ç–µ—Å—å –º–µ–¥–ª–µ–Ω–Ω–æ. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ—Å—å —Ä—É–∫–æ–π –∑–∞ —Å—Ç–µ–Ω—É –¥–ª—è —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è.</p>
        <p><strong>–ü–æ—á–µ–º—É —ç—Ç–æ —Ç–æ–ø:</strong> –ü–æ–ª–Ω–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞ –¥–≤–∏–∂–µ–Ω–∏—è –∏ –Ω–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ–≥–æ –≤–µ—Å–∞ —Ç–µ–ª–∞ –Ω–∞ –æ–¥–Ω—É –º—ã—à—Ü—É.</p>
      `,
      '–ì—Ä—É–¥—å': `
        <h3 style="margin-top:0; color:var(--accent);">–û—Ç–∂–∏–º–∞–Ω–∏—è —Å –Ω–æ–≥–∞–º–∏ –Ω–∞ –≤–æ–∑–≤—ã—à–µ–Ω–Ω–æ—Å—Ç–∏</h3>
        <p>–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è –±—ã—Å—Ç—Ä–æ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Å–ª–∏—à–∫–æ–º –ª–µ–≥–∫–∏–º–∏. –ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞—Å—Ç–∏—Ç—å –º—ã—à—Ü—ã –∏ —Å–∏–ª—É, –Ω—É–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É. –ü–æ–¥–Ω—è–≤ –Ω–æ–≥–∏ –≤—ã—à–µ –≥–æ–ª–æ–≤—ã, –º—ã —Å–º–µ—â–∞–µ–º —Ü–µ–Ω—Ç—Ä —Ç—è–∂–µ—Å—Ç–∏ –∏ –ø–µ—Ä–µ–Ω–æ—Å–∏–º –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤–µ—Å–∞ —Ç–µ–ª–∞ –Ω–∞ —Ä—É–∫–∏ –∏ –≥—Ä—É–¥—å, –æ—Å–æ–±–µ–Ω–Ω–æ –∞–∫—Ü–µ–Ω—Ç–∏—Ä—É—è –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤–µ—Ä—Ö–µ –≥—Ä—É–¥–Ω—ã—Ö –º—ã—à—Ü.</p>
        <p><strong>–¢–µ—Ö–Ω–∏–∫–∞:</strong> –ü—Ä–∏–º–∏—Ç–µ —É–ø–æ—Ä –ª–µ–∂–∞, –∑–∞—Ç–µ–º –ø–æ—Å—Ç–∞–≤—å—Ç–µ –Ω–æ—Å–∫–∏ –Ω–æ–≥ –Ω–∞ —É—Å—Ç–æ–π—á–∏–≤—ã–π —Å—Ç—É–ª, –¥–∏–≤–∞–Ω –∏–ª–∏ –∫—Ä–æ–≤–∞—Ç—å. –¢–µ–ª–æ –¥–æ–ª–∂–Ω–æ –æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω–æ –ø—Ä—è–º—É—é –ª–∏–Ω–∏—é –æ—Ç –ø—è—Ç–æ–∫ –¥–æ –º–∞–∫—É—à–∫–∏ (–ø–ª–∞–Ω–∫–∞). –†—É–∫–∏ –Ω–∞ —à–∏—Ä–∏–Ω–µ –ø–ª–µ—á –∏–ª–∏ —á—É—Ç—å —à–∏—Ä–µ. –ú–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å–∫–∞–π—Ç–µ—Å—å –≤–Ω–∏–∑, –ø–æ–∫–∞ –≥—Ä—É–¥—å –Ω–µ –æ–∫–∞–∂–µ—Ç—Å—è –≤ –ø–∞—Ä–µ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–æ–≤ –æ—Ç –ø–æ–ª–∞. –õ–æ–∫—Ç–∏ –¥–µ—Ä–∂–∏—Ç–µ –ø–æ–¥ —É–≥–ª–æ–º –ø—Ä–∏–º–µ—Ä–Ω–æ 45 –≥—Ä–∞–¥—É—Å–æ–≤ –∫ —Ç–µ–ª—É (–Ω–µ —Ä–∞–∑–≤–æ–¥–∏—Ç–µ –∏—Ö —à–∏—Ä–æ–∫–æ –≤ —Å—Ç–æ—Ä–æ–Ω—ã, —ç—Ç–æ –≤—Ä–µ–¥–Ω–æ –¥–ª—è –ø–ª–µ—á). –ú–æ—â–Ω–æ –≤—ã–∂–º–∏—Ç–µ —Å–µ–±—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ.</p>
        <p><strong>–ü–æ—á–µ–º—É —ç—Ç–æ —Ç–æ–ø:</strong> –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —É–≤–µ–ª–∏—á–∏—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å –±–∞–∑–æ–≤–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è –∏ –¥–∞—Ç—å –º—ã—à—Ü–∞–º —Å—Ç–∏–º—É–ª –∫ —Ä–æ—Å—Ç—É –±–µ–∑ –∂–µ–ª–µ–∑–∞.</p>
      `,
      '–°–ø–∏–Ω–∞': `
        <h3 style="margin-top:0; color:var(--accent);">–°–∫–æ–ª—å–∂–µ–Ω–∏–µ –ø–æ –ø–æ–ª—É –Ω–∞ –∂–∏–≤–æ—Ç–µ</h3>
        <p>–≠—Ç–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–∞—à —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å –∏ —Å–∏–ª—É —Ç—Ä–µ–Ω–∏—è –æ –ø–æ–ª –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ—â–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —à–∏—Ä–æ—á–∞–π—à–∏–µ –º—ã—à—Ü—ã —Å–ø–∏–Ω—ã –∏ –º—ã—à—Ü—ã, —Å–≤–æ–¥—è—â–∏–µ –ª–æ–ø–∞—Ç–∫–∏. –û–Ω–æ –æ—Ç–ª–∏—á–Ω–æ –∏–º–∏—Ç–∏—Ä—É–µ—Ç –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è –∏–ª–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É—é —Ç—è–≥—É.</p>
        <p><strong>–í–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è:</strong> –ì–ª–∞–¥–∫–∏–π –ø–æ–ª (–ª–∞–º–∏–Ω–∞—Ç, –ø–∞—Ä–∫–µ—Ç, –ø–ª–∏—Ç–∫–∞, –ª–∏–Ω–æ–ª–µ—É–º) –∏ –ø–æ–ª–æ—Ç–µ–Ω—Ü–µ –ø–æ–¥ –≥—Ä—É–¥—å/–∂–∏–≤–æ—Ç –¥–ª—è –ª—É—á—à–µ–≥–æ —Å–∫–æ–ª—å–∂–µ–Ω–∏—è.</p>
        <p><strong>–¢–µ—Ö–Ω–∏–∫–∞:</strong> –õ—è–≥—Ç–µ –Ω–∞ –∂–∏–≤–æ—Ç, –≤—ã—Ç—è–Ω—É–≤ —Ä—É–∫–∏ –≤–ø–µ—Ä–µ–¥ –∫–∞–∫ –º–æ–∂–Ω–æ –¥–∞–ª—å—à–µ. –í–¥–∞–≤–∏—Ç–µ –ª–∞–¥–æ–Ω–∏ –≤ –ø–æ–ª. –ù–∞–ø—Ä—è–≥–∞—è –º—ã—à—Ü—ã —Å–ø–∏–Ω—ã (–ø—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç–µ—Å—å –Ω–∞ —Ç—É—Ä–Ω–∏–∫–µ), —Å —Å–∏–ª–æ–π –ø–æ—Ç—è–Ω–∏—Ç–µ —Å–≤–æ–µ —Ç–µ–ª–æ –≤–ø–µ—Ä–µ–¥ –ø–æ –ø–æ–ª—É, —Å–≥–∏–±–∞—è —Ä—É–∫–∏ –≤ –ª–æ–∫—Ç—è—Ö –∏ —Å–≤–æ–¥—è –ª–æ–ø–∞—Ç–∫–∏ –≤–º–µ—Å—Ç–µ. –ù–æ–≥–∏ –¥–µ—Ä–∂–∏—Ç–µ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–Ω—ã–º–∏, –æ–Ω–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ–º–æ–≥–∞—Ç—å. –í –ø–∏–∫–æ–≤–æ–π —Ç–æ—á–∫–µ (–∫–æ–≥–¥–∞ –ª–æ–∫—Ç–∏ –±—É–¥—É—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ—Ä–ø—É—Å–∞) –∑–∞–¥–µ—Ä–∂–∏—Ç–µ—Å—å –Ω–∞ —Å–µ–∫—É–Ω–¥—É –∏ –º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç—Ç–æ–ª–∫–Ω–∏—Ç–µ—Å—å –æ–±—Ä–∞—Ç–Ω–æ –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ.</p>
        <p><strong>–ü–æ—á–µ–º—É —ç—Ç–æ —Ç–æ–ø:</strong> –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤ —Å–≤–æ–µ–º —Ä–æ–¥–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ, –ø–æ–∑–≤–æ–ª—è—é—â–µ–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ –Ω–∞–≥—Ä—É–∑–∏—Ç—å —Ç—è–≥–æ–≤—ã–µ –º—ã—à—Ü—ã —Å–ø–∏–Ω—ã –±–µ–∑ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ–ª—å–∫–æ —Å–∏–ª—É —Ç—Ä–µ–Ω–∏—è –∏ –≤–µ—Å —Ç–µ–ª–∞.</p>
      `,
      '–ö–æ—Ä': `
        <h3 style="margin-top:0; color:var(--accent);">–ö–Ω–∏–∂–∫–∞</h3>
        <p>–≠—Ç–æ "–∫–æ—Ä–æ–ª—å" –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –Ω–∞ –ø—Ä–µ—Å—Å. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏–π (—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–µ—Ä—Ö –ø—Ä–µ—Å—Å–∞) –∏–ª–∏ –ø–æ–¥—ä–µ–º–æ–≤ –Ω–æ–≥ (—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∏–∑), —Å–∫–ª–∞–¥–∫–∞ —Ç—Ä–µ–±—É–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –≤—Å–µ–π –ø—Ä—è–º–æ–π –º—ã—à—Ü—ã –∂–∏–≤–æ—Ç–∞ –∏ –º–æ—â–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–æ–≤, —á—Ç–æ–±—ã —É–¥–µ—Ä–∂–∞—Ç—å –±–∞–ª–∞–Ω—Å –Ω–∞ —è–≥–æ–¥–∏—Ü–∞—Ö.</p>
        <p><strong>–¢–µ—Ö–Ω–∏–∫–∞:</strong> –õ—è–≥—Ç–µ –Ω–∞ —Å–ø–∏–Ω—É, –Ω–æ–≥–∏ –ø—Ä—è–º—ã–µ, —Ä—É–∫–∏ –≤—ã—Ç—è–Ω—É—Ç—ã –∑–∞ –≥–æ–ª–æ–≤—É. –ü–æ—è—Å–Ω–∏—Ü–∞ –ø—Ä–∏–∂–∞—Ç–∞ –∫ –ø–æ–ª—É (—ç—Ç–æ –∏—Å—Ö–æ–¥–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è). –ù–∞ –≤—ã–¥–æ—Ö–µ –º–æ—â–Ω—ã–º –¥–≤–∏–∂–µ–Ω–∏–µ–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–¥–Ω–∏–º–∏—Ç–µ –ø—Ä—è–º—ã–µ –Ω–æ–≥–∏ –∏ –∫–æ—Ä–ø—É—Å –≤–≤–µ—Ä—Ö, —Å—Ç–∞—Ä–∞—è—Å—å –∫–æ—Å–Ω—É—Ç—å—Å—è —Ä—É–∫–∞–º–∏ —Å—Ç–æ–ø –≤ –≤–µ—Ä—Ö–Ω–µ–π —Ç–æ—á–∫–µ. –í–∞—à–µ —Ç–µ–ª–æ –¥–æ–ª–∂–Ω–æ —Å–ª–æ–∂–∏—Ç—å—Å—è –ø–æ–ø–æ–ª–∞–º, –∫–∞–∫ –∑–∞–∫—Ä—ã–≤–∞—é—â–∞—è—Å—è –∫–Ω–∏–≥–∞. –í –≤–µ—Ä—Ö–Ω–µ–π —Ç–æ—á–∫–µ –≤—ã –±–∞–ª–∞–Ω—Å–∏—Ä—É–µ—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–∞ —è–≥–æ–¥–∏—Ü–∞—Ö. –ú–µ–¥–ª–µ–Ω–Ω–æ –∏ –ø–æ–¥–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ, –Ω–µ —Ä–∞—Å—Å–ª–∞–±–ª—è—è –ø—Ä–µ—Å—Å –ø–æ–ª–Ω–æ—Å—Ç—å—é.</p>
        <p><strong>–ü–æ—á–µ–º—É —ç—Ç–æ —Ç–æ–ø:</strong> –û–¥–Ω–æ –¥–≤–∏–∂–µ–Ω–∏–µ –ø—Ä–æ—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–µ—Å—å "–∫–æ—Ä—Å–µ—Ç" —Å–ø–µ—Ä–µ–¥–∏ –∏ —É—á–∏—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º —Ç–µ–ª–æ–º –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.</p>
      `
    };

    const muscleImages = {
      '–ù–æ–≥–∏': 'images/–ù–æ–≥–∏.svg',
      '–ò–∫—Ä—ã': 'images/–ò–∫—Ä—ã.svg',
      '–ì—Ä—É–¥—å': 'images/–ì—Ä—É–¥—å.svg',
      '–°–ø–∏–Ω–∞': 'images/–°–ø–∏–Ω–∞.svg',
      '–ö–æ—Ä': 'images/–ö–æ—Ä.svg'
    };

    const exerciseConfig = {
      '–ù–æ–≥–∏': { time: 90, unilateral: true },
      '–ò–∫—Ä—ã': { time: 45, unilateral: true },
      '–ì—Ä—É–¥—å': { time: 60, unilateral: false },
      '–°–ø–∏–Ω–∞': { time: 60, unilateral: false },
      '–ö–æ—Ä': { time: 30, unilateral: false }
    };

    const trainings = ['A', 'B'];
    const sets = [1, 2, 3, 4];

    const STORAGE_KEY = 'home_workout_table_v1';
    const STATS_KEY = 'home_workout_stats_v1';

    let state = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};

    const keyOf = (m, t, s) => `${m}_${t}_${s}`;

    function render() {
      const table = document.getElementById('log');
      table.innerHTML = '';

      const thead = document.createElement('thead');
      thead.innerHTML = `<tr><th>–ú—ã—à—Ü—ã</th>${trainings.map(t => sets.map(s => `<th>${t}${s}</th>`).join('')).join('')}</tr>`;
      table.appendChild(thead);

      const tbody = document.createElement('tbody');

      muscles.forEach(m => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td class="group" onclick="openModal('${m}')">${m}</td>`;

        trainings.forEach(t => sets.forEach(s => {
          const key = keyOf(m, t, s);
          const cell = state[key] || { reps: '', done: false };
          const td = document.createElement('td');
          td.innerHTML = `
        <div class="cell">
          <input type="number" value="${cell.reps}" onchange="setReps('${key}',this.value)">
          <button class="set ${cell.done ? 'done' : ''}" onclick="toggle('${key}',this)">‚úì</button>
        </div>`;
          tr.appendChild(td);
        }));

        tbody.appendChild(tr);
      });

      table.appendChild(tbody);
    }

    function setReps(key, val) {
      state[key] = state[key] || { reps: '', done: false };
      state[key].reps = val;
    }

    function toggle(key, btn) {
      state[key] = state[key] || { reps: '', done: false };
      state[key].done = !state[key].done;
      btn.classList.toggle('done');

      if (state[key].done) {
        const stats = JSON.parse(localStorage.getItem(STATS_KEY)) || [];
        stats.push({ key, reps: Number(state[key].reps) || 0, ts: Date.now() });
        localStorage.setItem(STATS_KEY, JSON.stringify(stats));
        renderStats();
      }
    }

    function saveData() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    function resetData() {
      if (!confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ?')) return;
      localStorage.clear();
      state = {};
      render();
      renderStats();
    }

    function openModal(muscle) {
      currentMuscle = muscle;
      document.getElementById('modalTitle').innerText = muscle;
      document.getElementById('modalImg').src = muscleImages[muscle];
      document.getElementById('modalDesc').innerHTML = muscleDescriptions[muscle] || '';
      document.getElementById('modal').style.display = 'block';

      // Data
      const config = exerciseConfig[muscle] || { time: 60, unilateral: false };
      currentBaseTime = config.time;

      // Side Reminder
      const alertBox = document.getElementById('sideAlert');
      if (config.unilateral) {
        alertBox.style.display = 'block';
        alertBox.innerText = '‚ö†Ô∏è –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥—É—é —Å—Ç–æ—Ä–æ–Ω—É –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ';
        alertBox.style.borderColor = 'var(--accent)';
        alertBox.style.color = 'var(--accent)';
      } else {
        alertBox.style.display = 'none';
      }

      resetTimer();
    }

    function closeModal() {
      document.getElementById('modal').style.display = 'none';
      stopTimer(); // Ensure timer stops when closing
    }

    // Timer Logic
    let timerInterval = null;
    let timerTime = 0;
    let currentBaseTime = 60;
    let timerRunning = false;
    let timerIsCountdown = true;

    function formatTime(t) {
      const m = Math.floor(Math.abs(t) / 60).toString().padStart(2, '0');
      const s = (Math.abs(t) % 60).toString().padStart(2, '0');
      return `${m}:${s}`;
    }

    function updateTimerDisplay() {
      document.getElementById('timerDisplay').innerText = formatTime(timerTime);
    }

    function toggleTimer() {
      if (timerRunning) {
        stopTimer();
      } else {
        startTimer();
      }
    }

    function startTimer() {
      if (timerRunning) return;
      if (timerTime <= 0 && timerIsCountdown) return;

      timerRunning = true;
      document.getElementById('timerToggleBtn').innerText = 'Pause';
      document.getElementById('timerToggleBtn').classList.add('active');

      timerInterval = setInterval(() => {
        if (timerIsCountdown) {
          // Sound effects
          if (timerTime > 4) {
            playSound(1200, 0.02, 'sine', 0.3); // Light tick
          } else if (timerTime > 0) {
            playSound(600, 0.05, 'sine', 0.5); // Countdown beeps
          }

          timerTime--;

          if (timerTime <= 0) {
            timerTime = 0;
            playSound(800, 0.4, 'square', 0.3); // Finish sound
            stopTimer();

            // Unilateral check
            const config = exerciseConfig[currentMuscle];
            if (config && config.unilateral) {
              const alertBox = document.getElementById('sideAlert');
              alertBox.innerText = 'üîÑ –ü–ï–†–ï–ú–ï–ù–ê –°–¢–û–†–û–ù! –¢–ï–ü–ï–†–¨ –î–†–£–ì–ê–Ø –ù–û–ì–ê';
              alertBox.style.borderColor = '#fbbf24'; // Warning color (yellow/amber)
              alertBox.style.color = '#fbbf24';
            }
          }
        } else {
          timerTime++;
        }
        updateTimerDisplay();
      }, 1000);
    }

    // Audio Context & Zapper Logic
    let audioCtx = null;

    function initAudio() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
      if (audioCtx.state === 'suspended') audioCtx.resume();
      return audioCtx;
    }

    function playSound(freq, duration, type, vol = 1) {
      const ctx = initAudio();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.type = type;
      osc.frequency.value = freq;
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.start();
      gain.gain.setValueAtTime(vol, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.00001, ctx.currentTime + duration);
      osc.stop(ctx.currentTime + duration);
    }

    const zapper = {
      active: false,
      nodes: [],

      toggle() {
        if (this.active) this.stop();
        else this.start();
        this.updateUI();
      },

      start() {
        const ctx = initAudio();
        this.nodes = [];

        // 1. 30kHz Square Wave with Positive Offset
        // Hardware Limit Warning: Most speakers/DACs filter >20kHz. 
        // 30kHz at 44.1kHz SR will alias to ~14.1kHz.
        const mainOsc = ctx.createOscillator();
        mainOsc.type = 'square';
        mainOsc.frequency.value = 30000;

        const offset = ctx.createConstantSource ? ctx.createConstantSource() : ctx.createOscillator();
        if (offset.offset) offset.offset.value = 1; // ConstantSource
        else { offset.frequency.value = 0; offset.setPeriodicWave(ctx.createPeriodicWave(new Float32Array([1, 1]), new Float32Array([0, 0]))); } // Fallback

        const combiner = ctx.createGain();
        combiner.gain.value = 0.1; // Low volume for safety against heating/aliasing artifacts

        mainOsc.connect(combiner);
        offset.connect(combiner);
        combiner.connect(ctx.destination);

        mainOsc.start();
        offset.start();
        this.nodes.push(mainOsc, offset, combiner);

        // 2. Resonant Sweeps (Simulated High Frequencies)
        // Note: Web Audio clamps frequency to Nyquist (SampleRate / 2). 
        // 400kHz-900kHz is impossible in standard context. We simulate the *logic*.
        const ranges = [[77000, 400000], [350000, 500000], [500000, 900000]];

        ranges.forEach(([min, max]) => {
          const sweepOsc = ctx.createOscillator();
          sweepOsc.type = 'square';
          sweepOsc.frequency.value = Math.min(min, ctx.sampleRate / 2); // Clamp to physically possible

          // LFO to modulate freq to simulate "activity" in that band (if it were possible)
          const lfo = ctx.createOscillator();
          lfo.frequency.value = 0.1 + Math.random(); // Slow modulation
          const lfoGain = ctx.createGain();
          lfoGain.gain.value = 1000;

          lfo.connect(lfoGain);
          lfoGain.connect(sweepOsc.frequency);

          const vol = ctx.createGain();
          vol.gain.value = 0.001; // Extremely faint, purely symbolic/informational signal

          sweepOsc.connect(vol);
          vol.connect(ctx.destination);

          sweepOsc.start();
          lfo.start();
          this.nodes.push(sweepOsc, lfo, lfoGain, vol);
        });

        this.active = true;
      },

      stop() {
        this.nodes.forEach(n => {
          try { n.stop(); } catch (e) { }
          n.disconnect();
        });
        this.nodes = [];
        this.active = false;
      },

      updateUI() {
        const btn = document.getElementById('zapperBtn');
        const icon = document.getElementById('zapperIcon');
        const status = document.getElementById('zapperStatus');

        if (this.active) {
          icon.style.opacity = '1';
          icon.style.filter = 'drop-shadow(0 0 5px #38bdf8)';
          status.style.display = 'block';
          status.style.background = '#22c55e';
          status.style.boxShadow = '0 0 10px #22c55e';
          btn.style.borderColor = 'var(--accent)';
          btn.style.color = 'var(--accent)';
        } else {
          icon.style.opacity = '0.5';
          icon.style.filter = 'none';
          status.style.display = 'none';
          btn.style.borderColor = 'var(--border)';
          btn.style.color = 'var(--text)';
        }
      }
    };

    function toggleZapper() {
      zapper.toggle();
    }

    function stopTimer() {
      timerRunning = false;
      if (timerInterval) clearInterval(timerInterval);
    }

    function resetTimer() {
      stopTimer();
      timerTime = currentBaseTime;
      timerIsCountdown = true;
      updateTimerDisplay();
    }

    function addTime(seconds) {
      // If we add time, we assume the user wants a countdown (e.g. for rest)
      if (!timerIsCountdown && timerTime === 0) {
        timerIsCountdown = true;
      }

      // If was stopwatch (counting up) and we add time, switching to countdown might be confusing if we don't reset.
      // But typically "add 30s" implies "I want a timer for 30s".
      // Let's simpler logic: always add to current time constant.

      if (!timerIsCountdown && timerTime > 0) {
        // If we were counting up, and user clicks +30s, do we convert to countdown?
        // Or just add 30s to the elapsed time?
        // Usually in workout app, +30s button is for REST timer.
        // So let's force countdown mode.
        timerIsCountdown = true;
      }

      // If switching from stopwatch 0 to countdown, it's fine.
      timerIsCountdown = true;
      timerTime += seconds;
      updateTimerDisplay();
      if (!timerRunning) startTimer();
    }

    function renderStats() {
      const stats = JSON.parse(localStorage.getItem(STATS_KEY)) || [];
      const box = document.getElementById('stats');

      if (!stats.length) { box.innerHTML = '<span class="subtitle">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—É—Å—Ç–∞</span>'; return; }

      const sum = {};
      stats.forEach(e => {
        const m = e.key.split('_')[0];
        sum[m] = sum[m] || { sets: 0, reps: 0 };
        sum[m].sets++; sum[m].reps += e.reps;
      });

      box.innerHTML = `
    <h2>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
    <div class="stats-grid">
      ${Object.entries(sum).map(([m, v]) => `
        <div class="stat">
          <div class="label">${m}</div>
          <div class="value">${v.sets} ¬∑ ${v.reps}</div>
        </div>`).join('')}
    </div>`;
    }

    render();
    renderStats();
  </script>
</body>

</html>